/**
* react-masked-field 0.1.3
*
* Copyright (c) 2015 ZenPayroll
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.MaskedField=e()}}(function(){return function e(t,n,s){function r(o,a){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){var n=t[o][1][e];return r(n?n:e)},h,h.exports,e,t,n,s)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<s.length;o++)r(s[o]);return r}({1:[function(e,t,n){"use strict";var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},r=(window?window.React:null)||e("react"),i=e("./SelectionUtils"),o=i.getSelection,a=i.setSelection,u={9:/\d/,a:/[A-Za-z]/,"*":/[A-Za-z0-9]/},l="_",h=r.createClass({displayName:"MaskedField",propTypes:{mask:r.PropTypes.string,translations:r.PropTypes.object,value:r.PropTypes.string,placeholder:r.PropTypes.string,onChange:r.PropTypes.func,onKeyDown:r.PropTypes.func,onComplete:r.PropTypes.func,onFocus:r.PropTypes.func,onBlur:r.PropTypes.func,valueLink:r.PropTypes.object},getInitialState:function(){if(null==this.props.mask)return null;this._buffer=this._initialBuffer(),this._cursorPos=this._firstNonMaskIdx;var e=this._getPropsValue();return{value:e?this._maskedValue(e):""}},componentDidUpdate:function(){null!=this._cursorPos&&this._setSelection(this._cursorPos)},componentDidMount:function(){var e=this._getPropsValue();null!=this.props.mask&&null!=e&&this.state.value!==e&&this._callOnChange(this.state.value)},render:function(){var e={};return null!=this.props.mask&&(e={onChange:this._handleChange,onKeyDown:this._handleKeyDown,onFocus:this._handleFocus,onBlur:this._handleBlur,value:this.state.value,valueLink:null},null==this.props.placeholder&&(e.placeholder=this._initialBuffer().join(""))),r.createElement("input",s({},this.props,e,{type:"text"}))},_getSelection:function(){if(this.isMounted())return o(this.getDOMNode());var e=(this._getPropsValue()||"").length;return{start:e,end:e}},_setSelection:function(e){var t=arguments.length<=1||void 0===arguments[1]?e:arguments[1];return function(){a(this.getDOMNode(),e,t)}.apply(this,arguments)},_getPropsValue:function(){return null!=this.props.valueLink?this.props.valueLink.value:this.props.value},_getPattern:function(e){var t=this.props.mask[e],n=this.props.translations?this.props.translations[t]:null;return n||u[t]},_resetBuffer:function(e,t){for(var n=e;t>n;++n)this._getPattern(n)&&(this._buffer[n]=l)},_initialBuffer:function(){for(var e=[],t=0;t<this.props.mask.length;++t)this._getPattern(t)?(null==this._firstNonMaskIdx&&(this._firstNonMaskIdx=t),e.push("_")):e.push(this.props.mask[t]);return e},_isBufferEmpty:function(){var e=this;return this._buffer.every(function(t,n){return!e._getPattern(n)||t===l})},_isBufferFull:function(){var e=this;return this._buffer.every(function(t,n){return!e._getPattern(n)||t!==l})},_nextNonMaskIdx:function(e){for(var t=e+1;t<this.props.mask.length&&!this._getPattern(t);++t);return t},_prevNonMaskIdx:function(e){for(var t=e-1;t>=0&&!this._getPattern(t);--t);return t},_callOnChange:function(e){null!=this.props.valueLink?this.props.valueLink.requestChange(e):this.props.onChange&&this.props.onChange({target:{value:e}})},_callOnComplete:function(e){this.props.onComplete&&this._isBufferFull()&&this.props.onComplete(e)},_setValue:function(e){e!==this.state.value&&this._callOnChange(e),this.setState({value:e})},_handleFocus:function(e){var t=this;setTimeout(function(){return t._setSelection(t._cursorPos)},0),this.props.onFocus&&this.props.onFocus(e),this.setState({value:this._buffer.join("")})},_handleBlur:function(e){this._isBufferEmpty()&&this._setValue(""),this.props.onBlur&&this.props.onBlur(e)},_handleKeyDown:function(e){if("Backspace"===e.key||"Delete"===e.key){var t=this._getSelection(),n=t.start,s=t.end;n===s&&(n="Delete"===e.key?this._nextNonMaskIdx(n-1):this._prevNonMaskIdx(n),s=this._nextNonMaskIdx(n));var r=void 0,i=this._getPattern(n);i&&i.test(this._buffer[s])?r=this._maskedValue(this.state.value.substring(s),n):(this._resetBuffer(n,s),r=this._buffer.join("")),this._setValue(r),this._cursorPos=Math.max(n,this._firstNonMaskIdx),e.preventDefault()}this.props.onKeyDown&&this.props.onKeyDown(e)},_handleChange:function(e){var t=this._maskedValue(e.target.value);this._setValue(t),this._callOnComplete(t)},_maskedValue:function(e){for(var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=this._cursorPos=this._getSelection().start,s=t,r=0;s<this.props.mask.length;++s){var i=this._getPattern(s);if(i){var o=s;for(this._buffer[s]=l;r<e.length&&s<this.props.mask.length;){var a=e[r++];if(a===this._buffer[s])s++;else{if(i.test(a)){this._buffer[s]=a;break}this._cursorPos>o&&this._cursorPos--}}if(r>=e.length){this._resetBuffer(o+1,this.props.mask.length);break}}else this._buffer[s]===e[r]?(r===n&&this._cursorPos++,r++):n>=r&&this._cursorPos++}return this._buffer.join("")}});t.exports=h},{"./SelectionUtils":2,react:"react"}],2:[function(e,t,n){"use strict";t.exports={getSelection:function(e){var t=void 0,n=void 0;if(null!=e.setSelectionRange)t=e.selectionStart,n=e.selectionEnd;else{var s=document.selection.createRange();t=0-s.duplicate().moveStart("character",-1e5),n=t+s.text.length}return{start:t,end:n}},setSelection:function(e,t,n){if(null!=e.setSelectionRange)e.setSelectionRange(t,n);else{var s=e.createTextRange();s.collapse(!0),s.moveEnd("character",t),s.moveStart("character",n),s.select()}}}},{}]},{},[1])(1)});